' Gambas class file

Export
Create Static

Public Sub Init()
        'MDatabase.OpenDatabase()
End


Public Sub Delete(option_name As String)
        Dim rOptions As Result
        Init()
        rOptions = DB.Edit("options", "option_name = &1", option_name)
        Try rOptions.Delete
        If Error Then Return
End


Public Sub Add(option_name As String, option_value As String)
        Dim rOptions As Result
        Init()
        rOptions = DB.Create("options")
        rOptions!option_name = option_name
        rOptions!option_value = option_value
        Try rOptions.Update
        If Error Then Return
End

Public Sub Exist(option_name As String) As Boolean
        Dim rOptions As Result
        Init()
        rOptions = DB.Edit("options", "option_name = &1", option_name)
        If Not rOptions.Available Then
          Return False
        Endif
        Return True
End


Public Sub _get(option_name As String) As String
        Dim rOptions As Result
        Init()
        rOptions = DB.Edit("options", "option_name = &1", option_name)
        If Not rOptions.Available Then
          Return
        Endif
        Return rOptions!option_value
End

Public Sub _put(option_value As String, option_name As String)
        Dim rOptions As Result
        Init()
        rOptions = DB.Edit("options", "option_name = &1", option_name)
        If Not rOptions.Available Then
          Return
        Else
          rOptions!option_value = option_value
          rOptions.Update
          Return
        Endif
        Return
End

Public Sub GetAll()
        Dim rOptions As Result
        Dim Collect As Collection
        Init()
        rOptions = DB.Edit("options")
        For Each rOptions
          Print rOptions!option_value
        Next
End
